import DatePicker from 'react-datepicker';
import "react-datepicker/dist/react-datepicker.css";
import ru from 'date-fns/locale/ru';
import { registerLocale } from 'react-datepicker';
import { useEffect, useState } from 'react'; 
import useDateStore from '../../store/CalendarStore';

registerLocale('ru', ru); 

export default function ComponentDate() {
    const { date, updateDate } = useDateStore(); 
    const [startDate, setStartDate] = useState(date);

    useEffect(() => {
        setStartDate(date); 
    }, [date]);

    const handleDateChange = (selectedDate) => {
        console.log('Выбранная дата: ', selectedDate)
        setStartDate(selectedDate);
        updateDate(selectedDate); 
    }

    useEffect(() => {
        console.log('Текущая дата из store: ', date);
    }, [date]); 

    return (
        <div className='date-wrapper'>
            <DatePicker
                showIcon
                icon={
                   <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_605_386)">
                        <path d="M14.4188 3.70121V5.63023H1.14795V3.70121C1.15282 3.32866 1.30525 2.97325 1.5718 2.71292C1.83835 2.45259 2.19726 2.30859 2.56982 2.31252H3.51774V3.26043C3.51774 3.63754 3.66755 3.9992 3.9342 4.26585C4.20085 4.5325 4.56251 4.68231 4.93962 4.68231C5.31672 4.68231 5.67838 4.5325 5.94503 4.26585C6.21169 3.9992 6.36149 3.63754 6.36149 3.26043V2.31252H9.20524V3.26043C9.20524 3.63754 9.35504 3.9992 9.6217 4.26585C9.88835 4.5325 10.25 4.68231 10.6271 4.68231C11.0042 4.68231 11.3659 4.5325 11.6325 4.26585C11.8992 3.9992 12.049 3.63754 12.049 3.26043V2.31252H12.9969C13.3695 2.30859 13.7284 2.45259 13.9949 2.71292C14.2615 2.97325 14.4139 3.32866 14.4188 3.70121ZM1.14795 6.57814V14.1947C1.15282 14.5672 1.30525 14.9226 1.5718 15.1829C1.83835 15.4433 2.19726 15.5873 2.56982 15.5833H12.9969C13.3695 15.5873 13.7284 15.4433 13.9949 15.1829C14.2615 14.9226 14.4139 14.5672 14.4188 14.1947V6.57814H1.14795ZM5.41357 13.2136C5.4132 13.3391 5.36314 13.4595 5.27434 13.5483C5.18554 13.6371 5.0652 13.6871 4.93962 13.6875H3.9917C3.86611 13.6871 3.74578 13.6371 3.65697 13.5483C3.56817 13.4595 3.51812 13.3391 3.51774 13.2136V12.2656C3.51812 12.1401 3.56817 12.0197 3.65697 11.9309C3.74578 11.8421 3.86611 11.7921 3.9917 11.7917H4.93962C5.0652 11.7921 5.18554 11.8421 5.27434 11.9309C5.36314 12.0197 5.4132 12.1401 5.41357 12.2656V13.2136ZM5.41357 9.89585C5.4132 10.0214 5.36314 10.1418 5.27434 10.2306C5.18554 10.3194 5.0652 10.3694 4.93962 10.3698H3.9917C3.86611 10.3694 3.74578 10.3194 3.65697 10.2306C3.56817 10.1418 3.51812 10.0214 3.51774 9.89585V8.94793C3.51812 8.82235 3.56817 8.70201 3.65697 8.61321C3.74578 8.52441 3.86611 8.47435 3.9917 8.47398H4.93962C5.0652 8.47435 5.18554 8.52441 5.27434 8.61321C5.36314 8.70201 5.4132 8.82235 5.41357 8.94793V9.89585ZM8.73128 13.2136C8.73091 13.3391 8.68085 13.4595 8.59205 13.5483C8.50325 13.6371 8.38291 13.6871 8.25732 13.6875H7.30941C7.18382 13.6871 7.06349 13.6371 6.97468 13.5483C6.88588 13.4595 6.83582 13.3391 6.83545 13.2136V12.2656C6.83582 12.1401 6.88588 12.0197 6.97468 11.9309C7.06349 11.8421 7.18382 11.7921 7.30941 11.7917H8.25732C8.38291 11.7921 8.50325 11.8421 8.59205 11.9309C8.68085 12.0197 8.73091 12.1401 8.73128 12.2656V13.2136ZM8.73128 9.89585C8.73091 10.0214 8.68085 10.1418 8.59205 10.2306C8.50325 10.3194 8.38291 10.3694 8.25732 10.3698H7.30941C7.18382 10.3694 7.06349 10.3194 6.97468 10.2306C6.88588 10.1418 6.83582 10.0214 6.83545 9.89585V8.94793C6.83582 8.82235 6.88588 8.70201 6.97468 8.61321C7.06349 8.52441 7.18382 8.47435 7.30941 8.47398H8.25732C8.38291 8.47435 8.50325 8.52441 8.59205 8.61321C8.68085 8.70201 8.73091 8.82235 8.73128 8.94793V9.89585ZM12.049 9.89585C12.0486 10.0214 11.9986 10.1418 11.9098 10.2306C11.821 10.3194 11.7006 10.3694 11.575 10.3698H10.6271C10.5015 10.3694 10.3812 10.3194 10.2924 10.2306C10.2036 10.1418 10.1535 10.0214 10.1532 9.89585V8.94793C10.1535 8.82235 10.2036 8.70201 10.2924 8.61321C10.3812 8.52441 10.5015 8.47435 10.6271 8.47398H11.575C11.7006 8.47435 11.821 8.52441 11.9098 8.61321C11.9986 8.70201 12.0486 8.82235 12.049 8.94793V9.89585Z" fill="#BAC4D8"/>
                        <path d="M5.41349 2.31252V3.26044C5.41349 3.38614 5.36356 3.50669 5.27467 3.59558C5.18579 3.68446 5.06524 3.7344 4.93953 3.7344C4.81383 3.7344 4.69328 3.68446 4.6044 3.59558C4.51551 3.50669 4.46558 3.38614 4.46558 3.26044V2.31252C4.46558 2.18682 4.51551 2.06627 4.6044 1.97738C4.69328 1.8885 4.81383 1.83856 4.93953 1.83856C5.06524 1.83856 5.18579 1.8885 5.27467 1.97738C5.36356 2.06627 5.41349 2.18682 5.41349 2.31252ZM11.101 2.31252V3.26044C11.101 3.38614 11.0511 3.50669 10.9622 3.59558C10.8733 3.68446 10.7527 3.7344 10.627 3.7344C10.5013 3.7344 10.3808 3.68446 10.2919 3.59558C10.203 3.50669 10.1531 3.38614 10.1531 3.26044V2.31252C10.1531 2.18682 10.203 2.06627 10.2919 1.97738C10.3808 1.8885 10.5013 1.83856 10.627 1.83856C10.7527 1.83856 10.8733 1.8885 10.9622 1.97738C11.0511 2.06627 11.101 2.18682 11.101 2.31252Z" fill="#BAC4D8"/>
                        </g>
                        <defs>
                        <clipPath id="clip0_605_386">
                        <rect width="15.1667" height="15.1667" fill="white" transform="translate(0.199951 0.416687)"/>
                        </clipPath>
                        </defs>
                    </svg>

                }
                toggleCalendarOnIconClick
                selected={startDate}
                onChange={handleDateChange}
                dateFormat="MMMM y"
                locale="ru" 
                shouldCloseOnSelect={false}
                withPortal
            />
        </div>
    );
}

